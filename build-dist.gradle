apply from: 'build.gradle'

defaultTasks 'uploadArchives'
try {
    project.getByName("updateWrapper")
} catch (RuntimeException re) {
    assert false:
'''The current version of PgpPlugin is incompatible with the version of Gradle
that you are using.
What you must do until either Gradle or PgpPlugin gets fixed, is
    1:  Install Gradle v. 1.0-milestone-3 system
    2:  Build your jar file as usual, using 'gradlew' and the main build file
    3:  You must use the milestone 3 binary whenever you specify
        -b build-dist.gradle.  Something like:
            /path/to/gradle -b build-dist.gradle [-switches and targets]
'''
} 

buildscript {
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath 'de.huxhorn.gradle:de.huxhorn.gradle.pgp-plugin:0.0.3'
    }
}

//import de.huxhorn.gradle.pgp.PgpPlugin
//apply plugin: PgpPlugin
apply plugin: de.huxhorn.gradle.pgp.PgpPlugin

pgp {
    assert (project.hasProperty('pgp.secretKeyRingFile')
            && project.hasProperty('pgp.keyId')
            && project.hasProperty('pgp.password')) :
            "Properties 'pgp.secretKeyRingFile, pgp.keyId, pgp.password are required for our PgpPlugin integration"
    secretKeyRingFile = new File(project.property('pgp.secretKeyRingFile'))
    keyId = project.property('pgp.keyId')
    password =  project.property('pgp.password')
}
